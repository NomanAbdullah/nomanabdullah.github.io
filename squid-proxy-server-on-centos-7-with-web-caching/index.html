<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Squid Proxy Server on CentOS 7 With Web Caching - Noman Abdullah</title><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://nomanabdullah.github.io/squid-proxy-server-on-centos-7-with-web-caching/"><link rel="amphtml" href="https://nomanabdullah.github.io/amp/squid-proxy-server-on-centos-7-with-web-caching/"><link type="application/atom+xml" rel="alternate" href="https://nomanabdullah.github.io/feed.xml"><meta property="og:title" content="Squid Proxy Server on CentOS 7 With Web Caching"><meta property="og:image" content="https://nomanabdullah.github.io/media/posts/5/install-squid-proxy-server.jpg"><meta property="og:site_name" content="Noman Abdullah | Blog"><meta property="og:description" content="Hello Good People, In this post I am going to guide you to install and configure Squid proxy server on CentOS 7. Here, You will be able to use this proxy server for web caching as well. First, squid package should be installed using following&hellip;"><meta property="og:url" content="https://nomanabdullah.github.io/squid-proxy-server-on-centos-7-with-web-caching/"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Roboto:400,700%7CRoboto+Condensed:400,700&amp;subset=latin-ext" rel="stylesheet"><link rel="stylesheet" href="https://nomanabdullah.github.io/assets/css/style.css?v=aa41620c4f80dc7a8874270e3bdddd5b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://nomanabdullah.github.io/squid-proxy-server-on-centos-7-with-web-caching/"},"headline":"Squid Proxy Server on CentOS 7 With Web Caching","datePublished":"2019-04-17T19:53","dateModified":"2019-04-17T19:54","image":{"@type":"ImageObject","url":"https://nomanabdullah.github.io/media/posts/5/install-squid-proxy-server.jpg","height":555,"width":1280},"description":"Hello Good People, In this post I am going to guide you to install and configure Squid proxy server on CentOS 7. Here, You will be able to use this proxy server for web caching as well. First, squid package should be installed using following&hellip;","author":{"@type":"Person","name":"Noman Abdullah"},"publisher":{"@type":"Organization","name":"Noman Abdullah","logo":{"@type":"ImageObject","url":"https://nomanabdullah.github.io/media/website/cooltext320795718719250.png","height":62,"width":194}}}</script><script async src="https://nomanabdullah.github.io/assets/js/lazysizes.min.js?v=dc4b666bb3324aea4ead22e26059c761"></script><style>.top__search [type=search] {
						background-image: url(https://nomanabdullah.github.io/assets/svg/search.svg);
				    }</style></head><body><div class="container"><header class="js-top is-sticky"><a class="logo" href="https://nomanabdullah.github.io"><img src="https://nomanabdullah.github.io/media/website/cooltext320795718719250.png" alt="noman"></a><div class="top"><nav class="navbar js-navbar"><button class="navbar__toggle js-navbar__toggle">Menu</button><ul class="navbar__menu"></ul></nav><div class="top__search"><form action="https://nomanabdullah.github.io/search.html" class="search"><input type="search" name="q" placeholder="search..."></form></div></div></header><main><article class="post"><div class="hero"><div class="hero__wrap"><img src="https://nomanabdullah.github.io/media/posts/5/install-squid-proxy-server.jpg" sizes="(max-width: 1600px) 100vw, 1600px" srcset="https://nomanabdullah.github.io/media/posts/5/responsive/install-squid-proxy-server-xs.jpg 300w, https://nomanabdullah.github.io/media/posts/5/responsive/install-squid-proxy-server-sm.jpg 480w, https://nomanabdullah.github.io/media/posts/5/responsive/install-squid-proxy-server-md.jpg 768w, https://nomanabdullah.github.io/media/posts/5/responsive/install-squid-proxy-server-lg.jpg 1024w, https://nomanabdullah.github.io/media/posts/5/responsive/install-squid-proxy-server-xl.jpg 1360w, https://nomanabdullah.github.io/media/posts/5/responsive/install-squid-proxy-server-2xl.jpg 1600w" alt=""></div><header class="hero__text"><h1>Squid Proxy Server on CentOS 7 With Web Caching</h1><p class="post__meta"><time datetime="2019-04-17T19:53">April 17, 2019 </time>By <a href="https://nomanabdullah.github.io/authors/noman-abdullah/" rel="author" title="Noman Abdullah">Noman Abdullah</a></p></header></div><div class="post__entry"><p><strong>Hello Good People,</strong><br>In this post I am going to guide you to install and configure Squid proxy server on CentOS 7. Here, You will be able to use this proxy server for web caching as well.</p><p>First, squid package should be installed using following command:</p>Only Squid package: <br><address><code>#yum install squid</code></address>or<br>Squid with additional packages:<br><address><code>#yum install squid httpd-tools</code></address><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/001-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/001-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/001-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/001-md.png 768w" alt="" width="818" height="480"></address><p>Now, you have to start Squid server and check the status using those commands:</p><address><code>#systemctl start squid</code></address><address><code>#systemctl status squid</code></address><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/002-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/002-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/002-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/002-md.png 768w" alt="" width="820" height="534"></address><p>Check the IP address of the server and configure it to a browser to check whether it's working or not. Here, Firefox is used.</p><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/003-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/003-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/003-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/003-md.png 768w" alt="" width="1358" height="734"></address><p>Now, try to visit some website using the browser. If you can access to any website, proxy server works. If firewall is active in your server, you may get erorr. To get rid of it, you may use following commands:</p><address><code>#systemctl status firwalld</code></address><address><code>#firewall-cmd --permanent --add-service=squid</code></address><address><code>or</code></address><address><code>#firewall-cmd --permanent --add-service=3128/tcp</code></address><address> </address><address><code>#firewall-cmd --reload</code></address><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/04-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/04-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/04-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/04-md.png 768w" alt="" width="756" height="437"></address><p>Now, try to browse agian. you can check the access log file to get some information.</p><address><code>#cat /var/log/squid/access.log</code></address><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/004-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/004-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/004-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/004-md.png 768w" alt="" width="809" height="329"></address><p>To configure <strong>Web Caching</strong> in Squid proxy server, you have to edit <em>squid.conf</em> file. open the file using following command:</p><address><code>#vim /etc/squid/squid.conf</code></address><p>find the below line of <em><span style="text-decoration: underline;"># uncomment and adjust the following to add a disk cache directory.</span></em> this line and edit.</p><address><code>cache_dir ufs /var/cache/squid 200 16 256</code></address><address class="msg msg--highlight">If squid folder is not available in cache directory, you have to manually create it. And here, 200 is size of the disk; its 200MB, 16 is for level 1 directory and 256 is level 2 directory which is going to be created inside level 1 directory.</address><p>Refresh pattern should be modified as following:</p><address><code>refresh_pattern .*\(xml|html|htm|php|txt|css|js|jsp|asp):    10080    50%    43200</code></address><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/005-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/005-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/005-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/005-md.png 768w" alt="" width="814" height="612"></address><p>Now, try to restart the proxy server and check server status using following commands:</p><address><code>#systemctl stop squid</code></address><address><code>#systemctl start squid</code></address><address><code>#systemctl status squid</code></address><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/006-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/006-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/006-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/006-md.png 768w" alt="" width="812" height="576"></address><p>If you get any error to start the Squid proxy server, you have to change the directory user and permission.</p><address><code>#cat /etc/passwd | grep squid</code></address><address><code>#chown -R squid:squid /var/cache/</code></address><address class="msg msg--highlight">First, we are finding squid user from passwd file. Then we are changing cache/ directory owner to squid recursively (-R)</address><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/07-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/07-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/07-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/07-md.png 768w" alt="" width="434" height="228"></address><p>Now, try to restart the server, it will work. After setting up all those, it's time to check the cache directories.<img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/007-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/007-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/007-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/007-md.png 768w" alt="" width="765" height="328"></p><p>Well done! Level 1 has 16 directories and each of level 1 has 256 directories. Let's visit some websites from configured the browsers again. Make sure you have internet connectivity. Now, check the cache log using following command:</p><address><code># tail /var/log/squid/cache.log</code></address><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/008-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/008-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/008-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/008-md.png 768w" alt="" width="552" height="213"></address><p>This means your web caching just started working. Now, turn off the internet connectivity and try to browser same website again. Due to having cache enabled in your proxy server, you will be able to visit those previouly visited website without internet.</p><address><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/5/responsive/009-xs.png" data-sizes="auto" data-srcset="https://nomanabdullah.github.io/media/posts/5/responsive/009-xs.png 300w ,https://nomanabdullah.github.io/media/posts/5/responsive/009-sm.png 480w ,https://nomanabdullah.github.io/media/posts/5/responsive/009-md.png 768w" alt="" width="1364" height="738"></address><p>If you came upto now, <strong>Congratulations! </strong>you have just configured Squid proxy server with web caching successfully.<br><br><strong>Thank you</strong> for reading my blog.</p><address> </address><address> </address><p class="post__last-updated">This article was updated on April 17, 2019</p></div><aside class="post__share"></aside><footer class="post__footer"><div class="post__bio"><img src="https://nomanabdullah.github.io/media/website/a9f1befc-465a-434d-ac86-acfc475c7a50.jpg" alt="Noman Abdullah"><h3><a href="https://nomanabdullah.github.io/authors/noman-abdullah/" class="inverse" title="Noman Abdullah">Noman Abdullah</a></h3></div><nav class="post__nav"><div class="post__nav__prev">Previous Post<h5><a href="https://nomanabdullah.github.io/create-a-simple-http-server-using-python/" class="inverse" rel="prev">Create A Simple HTTP Server Using Python</a></h5></div></nav><div class="post__related"><h3>Related posts</h3><div class="post__related__wrap"><figure><a href="https://nomanabdullah.github.io/create-a-simple-http-server-using-python/"><img class="lazyload" src="https://nomanabdullah.github.io/media/posts/3/responsive/maxresdefault-xs.jpg" data-srcset="https://nomanabdullah.github.io/media/posts/3/responsive/maxresdefault-xs.jpg" data-expand="300" alt=""></a><figcaption><h4><a href="https://nomanabdullah.github.io/create-a-simple-http-server-using-python/" class="inverse">Create A Simple HTTP Server Using Python</a></h4><time datetime="2019-04-12T01:12">April 12, 2019</time></figcaption></figure></div></div></footer></article></main><footer class="footer"><div class="footer__social"><a href="https://www.facebook.com/nabdullah28" aria-label="Facebook"><svg class="icon"><use xlink:href="https://nomanabdullah.github.io/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://twitter.com/nabdullah_28" aria-label="Twitter"><svg class="icon"><use xlink:href="https://nomanabdullah.github.io/assets/svg/svg-map.svg#twitter"/></svg> </a><a href="https://www.instagram.com/nabdullah28" aria-label="Instagram"><svg class="icon"><use xlink:href="https://nomanabdullah.github.io/assets/svg/svg-map.svg#instagram"/></svg> </a><a href="https://www.linkedin.com/in/nabdullah28" aria-label="LinkedIn"><svg class="icon"><use xlink:href="https://nomanabdullah.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div><div class="footer__copyright">Copyright 2019 @ Noman Abdullah</div></footer></div><script defer="defer" src="https://nomanabdullah.github.io/assets/js/jquery-3.2.1.slim.min.js?v=f307ecc7f6353949f03c06ffa70652a2"></script><script defer="defer" src="https://nomanabdullah.github.io/assets/js/scripts.min.js?v=f37607af05f83050cdcc37ea18bb5ee1"></script></body></html>